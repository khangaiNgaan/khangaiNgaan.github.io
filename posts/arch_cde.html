<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>在 Arch 上安装 CDE - caffeine-Ink</title>
    <meta name="theme-color" content="#d8e3ed" media="(prefers-color-scheme: light)">
    <meta name="theme-color" content="#242931" media="(prefers-color-scheme: dark)">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="stylesheet" href="/css/posts.css">
    <link rel="stylesheet" href="/css/style.css">
    <script defer src="/scripts/favicon.js"></script>
    <script src="/scripts/os_detect.js"></script>
    <script>
      (function() {
          const savedMode = localStorage.getItem('theme-mode') || 'auto';
          let isDark = false;
          let isMono = false;
          if (savedMode === 'auto') {
              isDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
          } else if (savedMode === 'mono') {
              isMono = true;
          } else {
              isDark = (savedMode === 'dark');
          }
          if (isDark) {
              document.documentElement.setAttribute('data-theme', 'dark');
          } else if (isMono) {
              document.documentElement.setAttribute('data-theme', 'mono');
          }
      })();
    </script>
    <script defer src="https://cloud.umami.is/script.js" data-website-id="beed51c3-137a-47db-84ec-b76dcbd05158"></script>
  </head>
  <body>
    <div class="box">
      <div class="content">
        <div class="header">
            <span class="title">在 Arch 上安装 CDE</span>
            <span class="date">2025-04-30 / 5-02</span>
        </div>
        <br>
        <div class="header"><span class="back"><a href="/index.html">&lt; back to home</a></span><span class="date"><a href="#" id="darkModeButton">auto</a></span></div>
        <p class="highlight">简介</p>
        <p>通用桌面环境（Common Desktop Environment, CDE）是一个基于 Motif 的桌面环境，最初由 HP、IBM、Sun 等公司合作开发，在1990年代作为商用 Unix 工作站的标准桌面环境被广泛使用，直到2000年代初随着开源桌面环境（KDE, GNOME等）的兴起而被逐渐取代。2012年，CDE 宣布开源，随后被移植到 Linux 上，并被维护至今。</p>
        <img class="pics" src="/pics/arch_cdesktopenv.png" alt="CDE in Arch Linux">
        <p>目前 CDE 的代码主要托管在 <a href="https://sourceforge.net/projects/cdesktopenv/" target="_blank" rel="noopener noreferrer">SourceForge</a> 上。</p>
        <p class="highlight">准备工作</p>
        <p>启动计算机，进入 Arch Linux，在 tty 中登入 root 账户。使用有线或无线方式连接互联网，并确保网络连线正常。开始之前，最好先滚动更新一下系统。</p>
        <pre><code># pacman -Syu</code></pre>
        <p>我在安装前把 KDE Plasma 卸载了，如果你有安装别的桌面环境，可能得先停掉正在运行的图形界面服务。</p>
        <p class="highlight">安装依赖</p>
        <p>在安装 CDE 之前，需要先安装一些依赖包，这里是：</p>
        <pre><code># pacman -S xorg xorg-server-devel gcc dnsutils git libxinerama libxss ncurses openmotif rpcbind xbitmaps bison flex tcl</code></pre>
        <p>还有 ksh 和 ncompress：<span style="background-color: var(--text-color); color: var(--bg-color);">(!) Arch 2026.01.01 已可直接通过 pacman 安装</span></p>
        <pre><code># pacman -S ksh ncompress</code></pre>
        <p><span style="background-color: var(--text-color); color: var(--bg-color);">或</span></p>
        <pre><code># git clone https://aur.archlinux.org/ksh.git
# git clone https://aur.archlinux.org/ncompress.git</code></pre>
        <p>然后进入这两个目录，编译安装：</p>
        <pre><code># cd ksh
# makepkg -si
# cd ../ncompress
# makepkg -si</code></pre>
        <p>如果你已经安装了 yay 也可用 yay 安装：</p>
        <pre><code># yay -S ksh ncompress</code></pre>
        <p>手动创建 /lib/cpp 符号链接：<span style="background-color: var(--text-color); color: var(--bg-color);">(!) Arch 2026.01.01 已不再需要</span></p>
        <pre><code># ln -s /usr/bin/cpp /lib/cpp</code></pre>
        <p>这是必要的，CDE 的编译过程依赖于 C 预处理器（cpp）可执行文件位于 /lib/cpp 这个路径。</p>
        <p class="highlight">安装 CDE</p>
        <p>登出 root 账户，登入你的用户账户，以避免使用 root 账户登录图形界面。</p>
        <pre><code># exit</code></pre>
        <p>克隆 CDE 仓库：</p>
        <pre><code>$ git clone https://git.code.sf.net/p/cdesktopenv/code cdesktopenv-code</code></pre>
        <p>编译 CDE：</p>
        <pre><code>$ ./autogen.sh
$ ./configure
$ make
$ sudo make install</code></pre>
        <p>这个过程可能需要很长时间，安装完成后就可以启动 CDE 了。</p>
        <p class="highlight">启动 CDE</p>
        <p>在 tty 中输入：</p>
        <pre><code>$ startx /usr/dt/bin/Xsession</code></pre>
        <p>或者你也可以启动 CDE 自带的 dtlogin 登录管理器：</p>
        <pre><code>$ /usr/dt/bin/dtlogin -daemon</code></pre>
        <p>如果需要开机自动启动 dtlogin 的话，可以用任意文本编辑器在 /etc/systemd/system/ 目录下创建一个名为 dtlogin.service 的服务单元文件：</p>
        <pre><code>$ sudo vim /etc/systemd/system/dtlogin.service</code></pre>
        <p>添加以下内容：</p>
        <pre><code>[Unit]
Description=CDE Login Manager
Requires=rpcbind.service
After=systemd-user-sessions.service
          
[Service]
ExecStart=/usr/dt/bin/dtlogin

[Install]
Alias=display-manager.service</code></pre>
        <p>保存并退出：</p>
        <pre><code>:wq</code></pre>
        <p>启用服务：</p>
        <pre><code>$ sudo systemctl enable dtlogin.service</code></pre>
        <p>重启计算机，CDE 就会自动启动了。</p>
      <br>
      </div>
      <div class="back"><a href="/index.html">&lt; back to home</a></div>
      <footer>
        <br>
        <div class="copyright">Copyright (c) 2025-2026 caffeine-Ink. All rights reserved.</div>
      </footer>
    </div>
    <script src="/scripts/theme.js"></script>
  </body>
</html>